<!DOCTYPE html><html><head>
      <title>design</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\makiy\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.11\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="ソフトウェア設計書">ソフトウェア設計書 </h1>
<h2 id="要件">要件 </h2>
<table>
<thead>
<tr>
<th style="text-align:left">要件番号</th>
<th style="text-align:left">項目</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">neural network</td>
<td style="text-align:left">分岐のないニューラルネットワークを構築できること</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">deep-learning</td>
<td style="text-align:left">ニューラルネットワークの学習ができること</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">save-load</td>
<td style="text-align:left">ニューラルネットワークの情報を保存・呼び出しして再利用できること。</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">Flex-Initialize</td>
<td style="text-align:left">ニューラルネットワークの構成を指定して(Layerの組み換え)初期化が可能であること。</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">teacher data file</td>
<td style="text-align:left">外部で生成した教師データを読み込んで利用することができること</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">learning state</td>
<td style="text-align:left">学習進捗を出力することができること。</td>
</tr>
</tbody>
</table>
<h2 id="設計">設計 </h2>
<h3 id="機能一覧">機能一覧 </h3>
<table>
<thead>
<tr>
<th style="text-align:left">機能番号</th>
<th style="text-align:left">項目</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">foward calculation</td>
<td style="text-align:left">ニューラルネットワークの順方向の計算を実施する。入力の配列に対し計算結果の配列を出力する。</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">backword calculation</td>
<td style="text-align:left">ニューラルネットワークの逆方向の計算を実施する。ニューラルネットワークの出力と期待値の値を比較して、ニューラルネットワーク変数の修正を行う。（誤差逆伝播）</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">load teacher file</td>
<td style="text-align:left">教師データの読み込み。外部ファイルから教師データを読み込む</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">save neural network</td>
<td style="text-align:left">ニューラルネットワーク（構成・パラメータ）をファイルに保存する。</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">load neural network</td>
<td style="text-align:left">ニューラルネットワーク(構成・パラメータ)のファイルを読み込み、再構成する。</td>
</tr>
</tbody>
</table>
<h3 id="インターフェイスデザイン">インターフェイスデザイン </h3>
<h4 id="networkハンドラー">networkハンドラー </h4>
<h5 id="h_network">H_NETWORK </h5>
<h5 id="概要">概要 </h5>
<p>ニューラルネットワークを構成する複数のレイヤーの構造を保持する。<br>
ネットワーク全体でのフォワード計算と、誤差逆伝播法による学習を実行する。</p>
<h5 id="変数-s_network">変数　S_NETWORK </h5>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">size</td>
<td style="text-align:left">NETWORKのサイズ。含まれるLAYERの数。</td>
</tr>
<tr>
<td style="text-align:right">H_LIST</td>
<td style="text-align:left">hList_Layer</td>
<td style="text-align:left">NETWORKに含まれているLAYERハンドラのリストハンドラ</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">input_size</td>
<td style="text-align:left">ネットワークの入力要素数</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">output_size</td>
<td style="text-align:left">ネットワークの出力要素数</td>
</tr>
</tbody>
</table>
<h5 id="機能">機能 </h5>
<h6 id="h_network-create_network">H_NETWORK create_network </h6>
<p>・概要<br>
ネットワークハンドラを生成する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">input_size</td>
<td style="text-align:left">ネットワークの入力要素数</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">output_size</td>
<td style="text-align:left">ネットワークの出力要素数</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：ネットワークハンドラのポインタ<br>
異常：NULL</p>
<p>・エラー判定<br>
input_size=0<br>
output_size=0</p>
<h6 id="int-add_network">int add_network </h6>
<p>・概要<br>
ネットワークにLAYERを追加する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_NETWORK</td>
<td style="text-align:left">hNetwork</td>
<td style="text-align:left">対象のネットワークハンドラー</td>
</tr>
<tr>
<td style="text-align:right">LayerType</td>
<td style="text-align:left">LayerType</td>
<td style="text-align:left">追加するLAYERの種類</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">IF_size</td>
<td style="text-align:left">追加するLAYERの出力要素数</td>
</tr>
</tbody>
</table>
<p>※IF_sizeはAffineレイヤーのみ必要<br>
※SoftmaxWithLossレイヤーの出力要素数は自動的にネットワークの出力要素数を割り当てる。</p>
<p>・戻り値<br>
正常：0<br>
異常：1</p>
<p>・エラー判定<br>
LayerTypeが未定義値<br>
AffineレイヤーでIF_sizeが0<br>
LT_SoftmaxWithLossの後にレイヤーを追加するとき</p>
<h6 id="int-print_network">int print_network </h6>
<p>・概要<br>
ネットワークの構成情報を出力する</p>
<blockquote>
<p>出力例<br>
input : 3<br>
AffineLayer 3:4<br>
SigmoidLayer 4:4<br>
AffineLayer 4:4<br>
SoftmaxWithLossLayer 4:1<br>
output : 3</p>
</blockquote>
<p>・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_NETWORK</td>
<td style="text-align:left">hNetwork</td>
<td style="text-align:left">対象のネットワークハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：0<br>
異常：1</p>
<p>・エラー判定<br>
引数がNULL</p>
<h6 id="int-calc_forword">int calc_forword </h6>
<p>・概要<br>
ネットワーク順計算を実行し、結果を返す。</p>
<p>・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_NETWORK</td>
<td style="text-align:left">hNetwork</td>
<td style="text-align:left">対象のネットワークハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hInput</td>
<td style="text-align:left">入力変数の行列</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hOutput</td>
<td style="text-align:left">出力変数の行列</td>
</tr>
<tr>
<td style="text-align:right">double *</td>
<td style="text-align:left">pLoss</td>
<td style="text-align:left">損失関数の計算結果</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：0<br>
異常：1</p>
<p>・エラー判定<br>
引数が一つ以上NULL<br>
ネットワークの構造が不正<br>
入力・出力の要素数が不正</p>
<h6 id="int-calc_backward">int calc_backward </h6>
<p>・概要<br>
誤差逆伝播計算を実行し、レイヤーパラメータを更新する。</p>
<p>・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_NETWORK</td>
<td style="text-align:left">hNetwork</td>
<td style="text-align:left">対象のネットワークハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：0<br>
異常：1</p>
<p>・エラー判定<br>
引数がNULL</p>
<h6 id="int-function">int function </h6>
<p>・概要</p>
<p>・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_NETWORK</td>
<td style="text-align:left">hNetwork</td>
<td style="text-align:left">対象のネットワークハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：0<br>
異常：1</p>
<p>・エラー判定</p>
<h4 id="layerハンドラー">layerハンドラー </h4>
<h5 id="h_layer">H_LAYER </h5>
<h5 id="概要-1">概要 </h5>
<p>ニューラルネットワークの１レイヤーの情報を保持する。<br>
フォワード、バックワードの計算を提供する。<br>
決まった入力ベクトルのサイズと出力ベクトルのサイズを持つ。</p>
<h5 id="変数-s_layer">変数 S_LAYER </h5>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">int</td>
<td style="text-align:left">type</td>
<td style="text-align:left">layerのタイプ。1:ReLuレイヤー 2:Sigmoidレイヤー 3:Affineレイヤー 4:Sofmaxレイヤー 5:Sofmax-with-Lossレイヤー</td>
</tr>
<tr>
<td style="text-align:right">unsinged int</td>
<td style="text-align:left">input_size</td>
<td style="text-align:left">layerの入力要素数</td>
</tr>
<tr>
<td style="text-align:right">unsinged int</td>
<td style="text-align:left">output_size</td>
<td style="text-align:left">layerの出力要素数</td>
</tr>
<tr>
<td style="text-align:right">void *</td>
<td style="text-align:left">pLayerParams</td>
<td style="text-align:left">layer内部変数へのポインタ</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hForwardOutput</td>
<td style="text-align:left">順伝播計算の出力行列のハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hBackwardOutput</td>
<td style="text-align:left">逆伝播計算の出力行列のハンドラー</td>
</tr>
</tbody>
</table>
<h5 id="playerparamsの要素">pLayerParamsの要素 </h5>
<table>
<thead>
<tr>
<th style="text-align:left">Layer Type</th>
<th style="text-align:left">要素</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">LT_ReLU</td>
<td style="text-align:left">NULL</td>
</tr>
<tr>
<td style="text-align:left">LT_Sigmoid</td>
<td style="text-align:left">NULL</td>
</tr>
<tr>
<td style="text-align:left">LT_Affine</td>
<td style="text-align:left">void *pAffineParams[3]={hW,hB,hX}(ポインタ配列)</td>
</tr>
<tr>
<td style="text-align:left">LT_Softmax</td>
<td style="text-align:left">NULL</td>
</tr>
<tr>
<td style="text-align:left">LT_SoftmaxWithLoss</td>
<td style="text-align:left">void * pSWLParams[2]={hY,hT}(ポインタ配列)</td>
</tr>
</tbody>
</table>
<h5 id="各layer設計">各Layer設計 </h5>
<h6 id="relu">ReLU </h6>
<p>・概要<br>
各要素についてReLU活性化関数を作用させ、出力する。<br>
・入出力要素数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>inputsize</mtext><mo>=</mo><mtext>outputsize</mtext></mrow><annotation encoding="application/x-tex">\text{inputsize} = \text{outputsize}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">inputsize</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">outputsize</span></span></span></span></span></span><br>
・順伝播関数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">Y[i] =\begin{cases}
 0 &amp;\text{if }X[i]&lt;0 \\
X[i] &amp;\text{if }X[i]&gt;0
\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br>
・逆伝播関数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial X[i]} =\begin{cases}
 0 &amp;\text{if }Y[i]&lt;0 \\
 \frac{\partial L}{\partial Y[i]} &amp;\text{if }Y[i]&gt;0
\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.734em;"><span style="top:-3.734em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.294em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.234em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.734em;"><span style="top:-3.734em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.294em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.234em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h6 id="sigmoid">Sigmoid </h6>
<p>・概要<br>
各要素についてSigmoid活性化関数を作用させ、出力する。<br>
・入出力要素数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>inputsize</mtext><mo>=</mo><mtext>outputsize</mtext></mrow><annotation encoding="application/x-tex">\text{inputsize} = \text{outputsize}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">inputsize</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">outputsize</span></span></span></span></span></span><br>
・順伝播関数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mtext>exp</mtext><mo stretchy="false">(</mo><mo>−</mo><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y[i]=\frac1 {1+\text{exp}(-X[i])}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">exp</span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">])</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br>
・逆伝播関数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial X[i]} =\frac{\partial L}{\partial Y[i]} Y[i](1-Y[i])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">])</span></span></span></span></span></p>
<h6 id="affine">Affine </h6>
<p>・概要<br>
入力の配列に線形変換行列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>と<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>を作用させた結果を出力する。<br>
・入出力要素数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>のサイズは(outputsize,inputsize)<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>のサイズは(outputsize,1)<br>
・順伝播関数<br>
入力の配列を行列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>(inputsize,1)<br>
出力の配列を行列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>(outputsize,1)<br>
とする。<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>W</mi><mo>⋅</mo><mi>X</mi><mo>+</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">Y=W\cdot X+B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span><br>
つまり<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><mi>W</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>⋅</mo><mi>X</mi><mo stretchy="false">[</mo><mi>j</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>B</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Y[i,1]=\sum_j W[i,j]\cdot X[j,1]+B[i,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span><br>
・逆伝播関数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><mi>W</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial X[i]}=\sum_j\frac{\partial Y[j]}{\partial X[i]}\frac{\partial L}{\partial Y[j]}=\sum_j W[i,j]\cdot \frac{\partial L}{\partial Y[j]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8408em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>また<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>B</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mi>X</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
\frac{\partial L}{\partial B[i]} &amp;= \frac{\partial L}{\partial Y[i]} \\
\frac{\partial L}{\partial W[i,j]} &amp;= X[j]\cdot \frac{\partial L}{\partial Y[i]}
\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.056em;vertical-align:-1.278em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.778em;"><span style="top:-3.778em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.278em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.778em;"><span style="top:-3.778em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.278em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br>
もしくは<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac><mo>=</mo><msup><mi>W</mi><mi>T</mi></msup><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial X}=W^T \cdot\frac{\partial L}{\partial Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>⋅</mo><msup><mi>X</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial W}=\frac{\partial L}{\partial Y}\cdot X^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>B</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial B}=\frac{\partial L}{\partial Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h6 id="softmax">Softmax </h6>
<p>・概要<br>
・入出力要素数<br>
・順伝播関数<br>
・逆伝播関数</p>
<h6 id="softmaxwithloss">SoftmaxWithLoss </h6>
<p>・概要<br>
入力配列にソフトマックスを作用させて正規化し、さらに出力配列と期待値配列を直行エントロピー損失関数をかけて計算する。<br>
・入出力要素数<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>outputsize</mtext><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{outputsize}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">outputsize</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><br>
・順伝播関数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false">[</mo><mtext>inputsize</mtext><mo stretchy="false">]</mo><mo>→</mo><mi>Y</mi><mo stretchy="false">[</mo><mtext>inputsize</mtext><mo stretchy="false">]</mo><mi mathvariant="normal">&amp;</mi><mi>T</mi><mo stretchy="false">[</mo><mtext>inputsize</mtext><mo stretchy="false">]</mo><mo>→</mo><mi>L</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">X[\text{inputsize}]\to Y[\text{inputsize}] \&amp; T[\text{inputsize}]\to L[1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord text"><span class="mord">inputsize</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord text"><span class="mord">inputsize</span></span><span class="mclose">]</span><span class="mord">&amp;</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord text"><span class="mord">inputsize</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span>と計算を進める。(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>は期待値配列)<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mrow><mtext>exp</mtext><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mi>j</mi></munder><mtext>exp</mtext><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y[i]=\frac{\text{exp}(X[i])}{\sum_j \text{exp}(X[j])}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5488em;vertical-align:-1.1218em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">exp</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">])</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">exp</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">])</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L=-\sum_i T[i]ln(Y[i])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">])</span></span></span></span></span></p>
<p>・逆伝播関数</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mfrac><mo>=</mo><mi>Y</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial X[i]}=Y[i]-T[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span></p>
<h5 id="機能-1">機能 </h5>
<h6 id="h_layer-create_layer">H_LAYER create_layer </h6>
<p>・概要<br>
layerハンドラーを生成する。<br>
layer内部変数を作成し、ハンドラーに割り当てる。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">int</td>
<td style="text-align:left">type</td>
<td style="text-align:left">Layerタイプを指定する。</td>
</tr>
<tr>
<td style="text-align:right">int</td>
<td style="text-align:left">input_size</td>
<td style="text-align:left">layerの入力要素数</td>
</tr>
<tr>
<td style="text-align:right">int</td>
<td style="text-align:left">output_size</td>
<td style="text-align:left">layerの出力要素数</td>
</tr>
</tbody>
</table>
<p>・戻り値 H_LAYER<br>
正常：layerハンドラー<br>
異常：NULL</p>
<p>・エラー判定<br>
引数エラー<br>
　typeが定義されていない値である<br>
　<img src="https://latex.codecogs.com/gif.latex?\text{inputsize<1}"><br>
　<img src="https://latex.codecogs.com/gif.latex?\text{outputsize<1}"><br>
各typeに対してinputsize,outptsizeが不正<br>
動的メモリ獲得エラー</p>
<h6 id="int-delete_layer">int delete_layer </h6>
<p>・概要<br>
layerハンドラーを削除する。<br>
ハンドラー変数のメモリも開放する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">削除するLayerハンドラーを渡す</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：0<br>
異常：-1</p>
<p>・エラー判定<br>
引数がNULL</p>
<h6 id="int-print_layer">int print_layer </h6>
<p>・概要<br>
layerの情報を標準出力に表示する。<br>
id,type,入出力サイズ、計算パラメータを表示する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">出力対象のlayerのハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値int<br>
正常:0<br>
異常:-1<br>
・エラー<br>
引数がNULL</p>
<h6 id="void--pointerlayerparametersh_layer-hlayer">void * PointerLayerParameters(H_LAYER hLayer) </h6>
<p>・概要<br>
layerハンドラーの要素pLayerParamsを返す。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">対象のlayerのハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値void<br>
正常:pLayerParamsのポインタ<br>
異常:NULL</p>
<p>・エラー<br>
引数がNULL</p>
<h6 id="h_matrix-hmatrixforwardoutputh_layer-hlayer">H_MATRIX hMatrixForwardOutput(H_LAYER hLayer) </h6>
<p>・概要<br>
layerハンドラーの要素pForwardOutputを返す。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">対象のlayerのハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 H_MATRIX<br>
正常:順伝播計算の結果の行列のハンドラー<br>
異常:NULL</p>
<p>・エラー<br>
引数がNULL</p>
<h6 id="h_matrix-hmatrixforwardoutputh_layer-hlayer-1">H_MATRIX hMatrixForwardOutput(H_LAYER hLayer) </h6>
<p>・概要<br>
layerハンドラーの要素pForwardOutputを返す。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">対象のlayerのハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 H_MATRIX<br>
正常:逆伝播計算の結果の行列のハンドラー<br>
異常:NULL</p>
<p>・エラー<br>
引数がNULL</p>
<h6 id="int-calc_forward">int calc_forward </h6>
<p>・概要<br>
layerに順伝播の入力値を渡し、計算結果(pForwardOutput)を更新する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">出力対象のlayerのハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix</td>
<td style="text-align:left">入力値の配列</td>
</tr>
</tbody>
</table>
<p>・戻り値int<br>
正常:0<br>
異常:-1<br>
・エラー判定<br>
引数が１つ以上NULL<br>
計算エラー</p>
<h6 id="int-calc_backward-1">int calc_backward </h6>
<p>・概要<br>
layerに誤差逆伝播の入力値を渡し、計算結果(pBackwardOutput)を更新する。</p>
<p>・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LAYER</td>
<td style="text-align:left">hLayer</td>
<td style="text-align:left">出力対象のlayerのハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix</td>
<td style="text-align:left">入力値の配列</td>
</tr>
</tbody>
</table>
<p>・戻り値int<br>
正常:0<br>
異常:-1</p>
<p>・エラー判定<br>
引数が１つ以上NULL<br>
計算エラー</p>
<h4 id="matrixハンドラー">matrixハンドラー </h4>
<h5 id="h_matrix">H_MATRIX </h5>
<h5 id="概要-2">概要 </h5>
<p>行列情報の保持と計算を行う。<br>
行列のフォーマットは 行数:<img src="https://latex.codecogs.com/gif.latex?row">  配列:<img src="https://latex.codecogs.com/gif.latex?column"> で指定する。<br>
行列の要素数は <img src="https://latex.codecogs.com/gif.latex?size%20=%20row%20*%20column"> となる。<br>
行列の要素は行:<img src="https://latex.codecogs.com/gif.latex?i"> 列:<img src="https://latex.codecogs.com/gif.latex?j">で <img src="https://latex.codecogs.com/gif.latex?i*column+j">を指定する。<br>
以上、以下の表で概念を表す。</p>
<table>
<thead>
<tr>
<th style="text-align:right">i\j</th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">*</th>
<th style="text-align:center">j</th>
<th style="text-align:center">*</th>
<th style="text-align:center">column-1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:center">[0]</td>
<td style="text-align:center">[1]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[j]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[column-1]</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:center">[column+0]</td>
<td style="text-align:center">[column+1]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[column+i]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[2*column-1]</td>
</tr>
<tr>
<td style="text-align:right">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
</tr>
<tr>
<td style="text-align:right">i</td>
<td style="text-align:center">[i*column+0]</td>
<td style="text-align:center">[i*column+1]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[i*column+j]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">(i+1)*column-1</td>
</tr>
<tr>
<td style="text-align:right">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
</tr>
<tr>
<td style="text-align:right">row-1</td>
<td style="text-align:center">[(row-1)*column+0]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[(row-1)*column+j]</td>
<td style="text-align:center">*</td>
<td style="text-align:center">[row*column-1]</td>
</tr>
</tbody>
</table>
<h5 id="変数-s_matrix">変数 S_MATRIX </h5>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">double*</td>
<td style="text-align:left">pElem</td>
<td style="text-align:left">行列の値を持つ配列へのポインタ</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">row</td>
<td style="text-align:left">配列の行数</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">column</td>
<td style="text-align:left">配列の列数</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">size</td>
<td style="text-align:left">行列の総要素数</td>
</tr>
</tbody>
</table>
<h5 id="機能-2">機能 </h5>
<h6 id="h_matrix-create_matrix">H_MATRIX create_matrix </h6>
<p>・概要<br>
matrixハンドラーを生成する。<br>
matrixの内部配列を作成し、ハンドラーに割り当てる。<br>
行列の要素数を計算し変数に保存する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">row_size</td>
<td style="text-align:left">行列の行数</td>
</tr>
<tr>
<td style="text-align:right">unsinged int</td>
<td style="text-align:left">column_size</td>
<td style="text-align:left">行列の列数</td>
</tr>
</tbody>
</table>
<p>・戻り値 H_MATRIX<br>
正常：matrixハンドラー<br>
異常：NULL</p>
<h6 id="int-delete_matrix">int delete_matrix </h6>
<p>・概要<br>
matrixハンドラーを削除する。<br>
割り当てられた配列を解放する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix</td>
<td style="text-align:left">削除する対象の行列ハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：0<br>
異常：1</p>
<h6 id="int-add_matrix">int add_matrix </h6>
<p>・概要<br>
２つのmatrixの和を計算し計算結果を格納する。<br>
※２つの入力matrixと1つの出力matrixの形(行数、列数)はすべて同じであること。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_IN1</td>
<td style="text-align:left">入力の行列ハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_IN2</td>
<td style="text-align:left">入力の行列ハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_OUT</td>
<td style="text-align:left">出力先の行列ハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：0<br>
異常：1</p>
<h6 id="int-product_matrix">int product_matrix </h6>
<p>・概要<br>
２つのmatrixの内積を計算し計算結果を格納する。<br>
※入力1の列数=入力2の行数であり、出力の行数=入力１行数、出力の列数=入力２の列数であること。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_IN1</td>
<td style="text-align:left">入力の行列ハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_IN2</td>
<td style="text-align:left">入力の行列ハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_OUT</td>
<td style="text-align:left">出力先の行列ハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：0<br>
異常：1</p>
<h6 id="h_matrix-transpose_matrix">H_MATRIX transpose_matrix </h6>
<p>・概要<br>
matrixの転置行列を生成する<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix</td>
<td style="text-align:left">転置元の行列</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：0<br>
異常：1</p>
<h6 id="int-print_matrix">int print_matrix </h6>
<p>・概要<br>
matrixの要素を表示する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_IN1</td>
<td style="text-align:left">入力の行列ハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：ポインタ<br>
異常：NULL</p>
<p>・エラー判定<br>
引数がNULL</p>
<h6 id="int-copy_matrix">int copy_matrix </h6>
<p>・概要<br>
行列の要素の値をコピーする<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">引数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_IN</td>
<td style="text-align:left">コピー元の行列ハンドラー</td>
</tr>
<tr>
<td style="text-align:right">H_MATRIX</td>
<td style="text-align:left">hMatrix_OUT</td>
<td style="text-align:left">コピー先の行列ハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値 int<br>
正常：0<br>
異常：1</p>
<p>・エラー判定<br>
引数が一つ以上NULL<br>
コピー先とコピー元の行列のサイズが異なる</p>
<h4 id="listハンドラー">listハンドラー </h4>
<h5 id="h_list">H_LIST </h5>
<h5 id="概要-3">概要 </h5>
<p>動的リストの生成、削除、要素の取得、要素の検索、要素の追加、要素の削除を行う。</p>
<h5 id="変数-s_list">変数　S_LIST </h5>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">S_LIST_ELEM *</td>
<td style="text-align:left">pFirst</td>
<td style="text-align:left">先頭要素のポインタ</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">length</td>
<td style="text-align:left">リストの長さ</td>
</tr>
</tbody>
</table>
<h6 id="s_list_elem">S_LIST_ELEM </h6>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">void *</td>
<td style="text-align:left">pElem</td>
<td style="text-align:left">要素へのポインタ</td>
</tr>
<tr>
<td style="text-align:right">S_LIST_ELEM *</td>
<td style="text-align:left">次の要素へのポインタ</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h5 id="機能-3">機能 </h5>
<h6 id="h_list-create_list">H_LIST create_list </h6>
<p>・概要<br>
リストハンドラを生成する。<br>
・引数 void</p>
<p>・戻り値<br>
正常：リストハンドラ<br>
異常：NULL</p>
<h6 id="int-delete_list">int delete_list </h6>
<p>・概要<br>
リストハンドラを削除する<br>
所属するリスト要素を削除する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LIST</td>
<td style="text-align:left">hList</td>
<td style="text-align:left">削除する対象のリストハンドラー</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：リストハンドラ<br>
異常：NULL<br>
・エラー判定<br>
引数がNULL</p>
<h6 id="void--get_list">(void *) get_list </h6>
<p>・概要<br>
リストの要素を取得する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LIST</td>
<td style="text-align:left">hList</td>
<td style="text-align:left">対象のリストハンドラー</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">num</td>
<td style="text-align:left">取得したい要素の番号</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：要素のポインタ<br>
異常：NULL<br>
・エラー判定<br>
引数がNULL<br>
numがリストのlengthより大きい</p>
<h6 id="unsigned-int-find_list">unsigned int find_list </h6>
<p>・概要<br>
リストの要素を検索し、対象の要素の番号を返す。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LIST</td>
<td style="text-align:left">hList</td>
<td style="text-align:left">対象のリストハンドラー</td>
</tr>
<tr>
<td style="text-align:right">void *</td>
<td style="text-align:left">pElem</td>
<td style="text-align:left">検索したい要素のポインタ</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：要素の番号<br>
異常/対象なし：0<br>
・エラー判定<br>
引数がNULL</p>
<h6 id="int-append_list">int append_list </h6>
<p>・概要<br>
リストの最後尾に要素を追加する<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LIST</td>
<td style="text-align:left">hList</td>
<td style="text-align:left">対象のリストハンドラー</td>
</tr>
<tr>
<td style="text-align:right">void *</td>
<td style="text-align:left">pElem</td>
<td style="text-align:left">追加する要素のポインタ</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：0<br>
異常：1<br>
・エラー判定<br>
引数がNULL</p>
<h6 id="int-remove_elem_list">int remove_elem_list </h6>
<p>・概要<br>
指定の番号の要素をリストから削除する。<br>
・引数</p>
<table>
<thead>
<tr>
<th style="text-align:right">型</th>
<th style="text-align:left">変数名</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">H_LIST</td>
<td style="text-align:left">hList</td>
<td style="text-align:left">対象のリストハンドラー</td>
</tr>
<tr>
<td style="text-align:right">unsigned int</td>
<td style="text-align:left">num</td>
<td style="text-align:left">削除する要素の番号</td>
</tr>
</tbody>
</table>
<p>・戻り値<br>
正常：１<br>
異常：０<br>
・エラー判定<br>
引数がNULL<br>
numがlengthより大きい or num=0</p>
<h3 id="固定値">固定値 </h3>
<h4 id="layerタイプlt_">Layerタイプ(LT_*) </h4>
<table>
<thead>
<tr>
<th style="text-align:right">値</th>
<th style="text-align:left">名前</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:left">LT_ReLU</td>
<td style="text-align:left">ReLUレイヤー</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:left">LT_Sigmoid</td>
<td style="text-align:left">Sigmoidレイヤー</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:left">LT_Affine</td>
<td style="text-align:left">Affineレイヤー</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:left">LT_Softmax</td>
<td style="text-align:left">Softmaxレイヤー</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:left">LT_SoftmaxWithLoss</td>
<td style="text-align:left">Sofmax-with-Lossレイヤー</td>
</tr>
</tbody>
</table>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>